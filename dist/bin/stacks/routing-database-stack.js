import * as cdk from "aws-cdk-lib";
import * as aws_dynamodb from "aws-cdk-lib/aws-dynamodb";
import { AttributeType, BillingMode } from "aws-cdk-lib/aws-dynamodb";
export const DynamoDBTableProps = {
    RoutesDbTable: {
        Name: "RoutesDB",
        PartitionKeyName: "pairTradeTypeChainId",
        SortKeyName: "routeId",
    },
    RoutesDbCachingRequestFlagTable: {
        Name: "RoutesDbCacheReqFlagDB",
        PartitionKeyName: "pairTradeTypeChainId",
        SortKeyName: "amount",
    },
    CacheRouteDynamoDbTable: {
        Name: "RouteCachingDB",
        PartitionKeyName: "pairTradeTypeChainId",
        SortKeyName: "protocolsBucketBlockNumber",
    },
    CachingRequestFlagDynamoDbTable: {
        Name: "CacheReqFlagDB",
        PartitionKeyName: "pairTradeTypeChainId",
        SortKeyName: "protocolsBucketBlockNumber",
    },
    V3PoolsDynamoDbTable: {
        Name: "V3PoolsCachingDB",
        PartitionKeyName: "poolAddress",
        SortKeyName: "blockNumber",
    },
    TokenPropertiesCachingDbTable: {
        Name: "TokenPropertiesCachingDb",
        PartitionKeyName: "chainIdTokenAddress",
    },
    TTLAttributeName: "ttl",
};
export class RoutingDatabaseStack extends cdk.NestedStack {
    constructor(scope, name, props) {
        super(scope, name, props);
        // Creates a DynamoDB Table for storing the routes
        this.routesDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.RoutesDbTable.Name, {
            tableName: DynamoDBTableProps.RoutesDbTable.Name,
            partitionKey: { name: DynamoDBTableProps.RoutesDbTable.PartitionKeyName, type: AttributeType.STRING },
            sortKey: { name: DynamoDBTableProps.RoutesDbTable.SortKeyName, type: AttributeType.NUMBER },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the buckets that are flagging as already cached in the RoutesDb
        this.routesDbCachingRequestFlagDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.RoutesDbCachingRequestFlagTable.Name, {
            tableName: DynamoDBTableProps.RoutesDbCachingRequestFlagTable.Name,
            partitionKey: {
                name: DynamoDBTableProps.RoutesDbCachingRequestFlagTable.PartitionKeyName,
                type: AttributeType.STRING,
            },
            sortKey: { name: DynamoDBTableProps.RoutesDbCachingRequestFlagTable.SortKeyName, type: AttributeType.NUMBER },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the cached routes
        this.cachedRoutesDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.CacheRouteDynamoDbTable.Name, {
            tableName: DynamoDBTableProps.CacheRouteDynamoDbTable.Name,
            partitionKey: { name: DynamoDBTableProps.CacheRouteDynamoDbTable.PartitionKeyName, type: AttributeType.STRING },
            sortKey: { name: DynamoDBTableProps.CacheRouteDynamoDbTable.SortKeyName, type: AttributeType.STRING },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the buckets that are flagging as already cached in the CachedRoutesDb
        this.cachingRequestFlagDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.CachingRequestFlagDynamoDbTable.Name, {
            tableName: DynamoDBTableProps.CachingRequestFlagDynamoDbTable.Name,
            partitionKey: {
                name: DynamoDBTableProps.CachingRequestFlagDynamoDbTable.PartitionKeyName,
                type: AttributeType.STRING,
            },
            sortKey: { name: DynamoDBTableProps.CachingRequestFlagDynamoDbTable.SortKeyName, type: AttributeType.STRING },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the cached v3 pools
        this.cachedV3PoolsDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.V3PoolsDynamoDbTable.Name, {
            tableName: DynamoDBTableProps.V3PoolsDynamoDbTable.Name,
            partitionKey: { name: DynamoDBTableProps.V3PoolsDynamoDbTable.PartitionKeyName, type: AttributeType.STRING },
            sortKey: { name: DynamoDBTableProps.V3PoolsDynamoDbTable.SortKeyName, type: AttributeType.NUMBER },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a TokenValidationResult Table for storing the FOT/SFT tokens
        this.tokenPropertiesCachingDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.TokenPropertiesCachingDbTable.Name, {
            tableName: DynamoDBTableProps.TokenPropertiesCachingDbTable.Name,
            partitionKey: {
                name: DynamoDBTableProps.TokenPropertiesCachingDbTable.PartitionKeyName,
                type: AttributeType.STRING,
            },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGluZy1kYXRhYmFzZS1zdGFjay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2Jpbi9zdGFja3Mvcm91dGluZy1kYXRhYmFzZS1zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssR0FBRyxNQUFNLGFBQWEsQ0FBQztBQUNuQyxPQUFPLEtBQUssWUFBWSxNQUFNLDBCQUEwQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxhQUFhLEVBQUUsV0FBVyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFLdEUsTUFBTSxDQUFDLE1BQU0sa0JBQWtCLEdBQUc7SUFDaEMsYUFBYSxFQUFFO1FBQ2IsSUFBSSxFQUFFLFVBQVU7UUFDaEIsZ0JBQWdCLEVBQUUsc0JBQXNCO1FBQ3hDLFdBQVcsRUFBRSxTQUFTO0tBQ3ZCO0lBQ0QsK0JBQStCLEVBQUU7UUFDL0IsSUFBSSxFQUFFLHdCQUF3QjtRQUM5QixnQkFBZ0IsRUFBRSxzQkFBc0I7UUFDeEMsV0FBVyxFQUFFLFFBQVE7S0FDdEI7SUFDRCx1QkFBdUIsRUFBRTtRQUN2QixJQUFJLEVBQUUsZ0JBQWdCO1FBQ3RCLGdCQUFnQixFQUFFLHNCQUFzQjtRQUN4QyxXQUFXLEVBQUUsNEJBQTRCO0tBQzFDO0lBQ0QsK0JBQStCLEVBQUU7UUFDL0IsSUFBSSxFQUFFLGdCQUFnQjtRQUN0QixnQkFBZ0IsRUFBRSxzQkFBc0I7UUFDeEMsV0FBVyxFQUFFLDRCQUE0QjtLQUMxQztJQUNELG9CQUFvQixFQUFFO1FBQ3BCLElBQUksRUFBRSxrQkFBa0I7UUFDeEIsZ0JBQWdCLEVBQUUsYUFBYTtRQUMvQixXQUFXLEVBQUUsYUFBYTtLQUMzQjtJQUVELDZCQUE2QixFQUFFO1FBQzdCLElBQUksRUFBRSwwQkFBMEI7UUFDaEMsZ0JBQWdCLEVBQUUscUJBQXFCO0tBQ3hDO0lBQ0QsZ0JBQWdCLEVBQUUsS0FBSztDQUN4QixDQUFDO0FBRUYsTUFBTSxPQUFPLG9CQUFxQixTQUFRLEdBQUcs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QjtTQUN6RCxDQUNGLENBQUM7UUFFRiwyREFBMkQ7UUFDM0QsSUFBSSxDQUFDLHFCQUFxQixHQUFHLElBQUksWUFBWSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsa0JBQWtCLENBQUMsb0JBQW9CLENBQUMsSUFBSSxFQUFFO1lBQ3RHLFNBQVMsRUFBRSxrQkFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJO1lBQ3ZELFlBQVksRUFBRSxFQUFFLElBQUksRUFBRSxrQkFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsYUFBYSxDQUFDLE1BQU0sRUFBRTtZQUM1RyxPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsa0JBQWtCLENBQUMsb0JBQW9CLENBQUMsV0FBVyxFQUFFLElBQUksRUFBRSxhQUFhLENBQUMsTUFBTSxFQUFFO1lBQ2xHLFdBQVcsRUFBRSxXQUFXLENBQUMsZUFBZTtZQUN4QyxtQkFBbUIsRUFBRSxrQkFBa0IsQ0FBQyxnQkFBZ0I7U0FDekQsQ0FBQyxDQUFDO1FBRUgsdUVBQXVFO1FBQ3ZFLElBQUksQ0FBQyw4QkFBOEIsR0FBRyxJQUFJLFlBQVksQ0FBQyxLQUFLLENBQzFELElBQUksRUFDSixrQkFBa0IsQ0FBQyw2QkFBNkIsQ0FBQyxJQUFJLEVBQ3JEO1lBQ0UsU0FBUyxFQUFFLGtCQUFrQixDQUFDLDZCQUE2QixDQUFDLElBQUk7WUFDaEUsWUFBWSxFQUFFO2dCQUNaLElBQUksRUFBRSxrQkFBa0IsQ0FBQyw2QkFBNkIsQ0FBQyxnQkFBZ0I7Z0JBQ3ZFLElBQUksRUFBRSxhQUFhLENBQUMsTUFBTTthQUMzQjtZQUNELFdBQVcsRUFBRSxXQUFXLENBQUMsZUFBZTtZQUN4QyxtQkFBbUIsRUFBRSxrQkFBa0IsQ0FBQyxnQkFBZ0I7U0FDekQsQ0FDRixDQUFDO0lBQ0osQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgY2RrIGZyb20gXCJhd3MtY2RrLWxpYlwiO1xuaW1wb3J0ICogYXMgYXdzX2R5bmFtb2RiIGZyb20gXCJhd3MtY2RrLWxpYi9hd3MtZHluYW1vZGJcIjtcbmltcG9ydCB7IEF0dHJpYnV0ZVR5cGUsIEJpbGxpbmdNb2RlIH0gZnJvbSBcImF3cy1jZGstbGliL2F3cy1keW5hbW9kYlwiO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSBcImNvbnN0cnVjdHNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBSb3V0aW5nRGF0YWJhc2VTdGFja1Byb3BzIGV4dGVuZHMgY2RrLk5lc3RlZFN0YWNrUHJvcHMge31cblxuZXhwb3J0IGNvbnN0IER5bmFtb0RCVGFibGVQcm9wcyA9IHtcbiAgUm91dGVzRGJUYWJsZToge1xuICAgIE5hbWU6IFwiUm91dGVzREJcIixcbiAgICBQYXJ0aXRpb25LZXlOYW1lOiBcInBhaXJUcmFkZVR5cGVDaGFpbklkXCIsXG4gICAgU29ydEtleU5hbWU6IFwicm91dGVJZFwiLFxuICB9LFxuICBSb3V0ZXNEYkNhY2hpbmdSZXF1ZXN0RmxhZ1RhYmxlOiB7XG4gICAgTmFtZTogXCJSb3V0ZXNEYkNhY2hlUmVxRmxhZ0RCXCIsXG4gICAgUGFydGl0aW9uS2V5TmFtZTogXCJwYWlyVHJhZGVUeXBlQ2hhaW5JZFwiLFxuICAgIFNvcnRLZXlOYW1lOiBcImFtb3VudFwiLFxuICB9LFxuICBDYWNoZVJvdXRlRHluYW1vRGJUYWJsZToge1xuICAgIE5hbWU6IFwiUm91dGVDYWNoaW5nREJcIixcbiAgICBQYXJ0aXRpb25LZXlOYW1lOiBcInBhaXJUcmFkZVR5cGVDaGFpbklkXCIsXG4gICAgU29ydEtleU5hbWU6IFwicHJvdG9jb2xzQnVja2V0QmxvY2tOdW1iZXJcIixcbiAgfSxcbiAgQ2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGJUYWJsZToge1xuICAgIE5hbWU6IFwiQ2FjaGVSZXFGbGFnREJcIixcbiAgICBQYXJ0aXRpb25LZXlOYW1lOiBcInBhaXJUcmFkZVR5cGVDaGFpbklkXCIsXG4gICAgU29ydEtleU5hbWU6IFwicHJvdG9jb2xzQnVja2V0QmxvY2tOdW1iZXJcIixcbiAgfSxcbiAgVjNQb29sc0R5bmFtb0RiVGFibGU6IHtcbiAgICBOYW1lOiBcIlYzUG9vbHNDYWNoaW5nREJcIixcbiAgICBQYXJ0aXRpb25LZXlOYW1lOiBcInBvb2xBZGRyZXNzXCIsXG4gICAgU29ydEtleU5hbWU6IFwiYmxvY2tOdW1iZXJcIixcbiAgfSxcblxuICBUb2tlblByb3BlcnRpZXNDYWNoaW5nRGJUYWJsZToge1xuICAgIE5hbWU6IFwiVG9rZW5Qcm9wZXJ0aWVzQ2FjaGluZ0RiXCIsXG4gICAgUGFydGl0aW9uS2V5TmFtZTogXCJjaGFpbklkVG9rZW5BZGRyZXNzXCIsXG4gIH0sXG4gIFRUTEF0dHJpYnV0ZU5hbWU6IFwidHRsXCIsXG59O1xuXG5leHBvcnQgY2xhc3MgUm91dGluZ0RhdGFiYXNlU3RhY2sgZXh0ZW5kcyBjZGsuTmVzdGVkU3RhY2sge1xuICBwdWJsaWMgcmVhZG9ubHkgcm91dGVzRHluYW1vRGI6IGF3c19keW5hbW9kYi5UYWJsZTtcbiAgcHVibGljIHJlYWRvbmx5IHJvdXRlc0RiQ2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGI6IGF3c19keW5hbW9kYi5UYWJsZTtcblxuICAvLyBXQVJOSU5HOiBldmVuIHRob3VnaCBjYWNoZWRSb3V0ZXNEeW5hbW9EYiBhbmQgY2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGIgYXJlIG5vdCB1c2VkIGluIHByb2RcbiAgLy8gICAgICAgICAgd2Ugc3RpbGwgaGF2ZSB0byBrZWVwIHRoZXJlIGhlcmUuIFJlbW92aW5nIHRoZW0gd2lsbCBjYXVzZSByb3V0ZXMgREIgdG8gc3RvcCByZWNlaXZpbmdcbiAgLy8gICAgICAgICAgY2FjaGVkIHJvdXRlcy4gV2UgZG9uJ3Qga25vdyB3aHksIGJ1dCBsZXQncyBub3QgZGVsZXRlIGNhY2hlZFJvdXRlc0R5bmFtb0RiIG9yIGNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiXG4gIHB1YmxpYyByZWFkb25seSBjYWNoZWRSb3V0ZXNEeW5hbW9EYjogYXdzX2R5bmFtb2RiLlRhYmxlO1xuICBwdWJsaWMgcmVhZG9ubHkgY2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGI6IGF3c19keW5hbW9kYi5UYWJsZTtcblxuICBwdWJsaWMgcmVhZG9ubHkgY2FjaGVkVjNQb29sc0R5bmFtb0RiOiBhd3NfZHluYW1vZGIuVGFibGU7XG5cbiAgcHVibGljIHJlYWRvbmx5IHRva2VuUHJvcGVydGllc0NhY2hpbmdEeW5hbW9EYjogYXdzX2R5bmFtb2RiLlRhYmxlO1xuXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIG5hbWU6IHN0cmluZywgcHJvcHM6IFJvdXRpbmdEYXRhYmFzZVN0YWNrUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgbmFtZSwgcHJvcHMpO1xuXG4gICAgLy8gQ3JlYXRlcyBhIER5bmFtb0RCIFRhYmxlIGZvciBzdG9yaW5nIHRoZSByb3V0ZXNcbiAgICB0aGlzLnJvdXRlc0R5bmFtb0RiID0gbmV3IGF3c19keW5hbW9kYi5UYWJsZSh0aGlzLCBEeW5hbW9EQlRhYmxlUHJvcHMuUm91dGVzRGJUYWJsZS5OYW1lLCB7XG4gICAgICB0YWJsZU5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5Sb3V0ZXNEYlRhYmxlLk5hbWUsXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlJvdXRlc0RiVGFibGUuUGFydGl0aW9uS2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgIHNvcnRLZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlJvdXRlc0RiVGFibGUuU29ydEtleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuTlVNQkVSIH0sXG4gICAgICBiaWxsaW5nTW9kZTogQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGVzIGEgRHluYW1vREIgVGFibGUgZm9yIHN0b3JpbmcgdGhlIGJ1Y2tldHMgdGhhdCBhcmUgZmxhZ2dpbmcgYXMgYWxyZWFkeSBjYWNoZWQgaW4gdGhlIFJvdXRlc0RiXG4gICAgdGhpcy5yb3V0ZXNEYkNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiID0gbmV3IGF3c19keW5hbW9kYi5UYWJsZShcbiAgICAgIHRoaXMsXG4gICAgICBEeW5hbW9EQlRhYmxlUHJvcHMuUm91dGVzRGJDYWNoaW5nUmVxdWVzdEZsYWdUYWJsZS5OYW1lLFxuICAgICAge1xuICAgICAgICB0YWJsZU5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5Sb3V0ZXNEYkNhY2hpbmdSZXF1ZXN0RmxhZ1RhYmxlLk5hbWUsXG4gICAgICAgIHBhcnRpdGlvbktleToge1xuICAgICAgICAgIG5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5Sb3V0ZXNEYkNhY2hpbmdSZXF1ZXN0RmxhZ1RhYmxlLlBhcnRpdGlvbktleU5hbWUsXG4gICAgICAgICAgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcsXG4gICAgICAgIH0sXG4gICAgICAgIHNvcnRLZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlJvdXRlc0RiQ2FjaGluZ1JlcXVlc3RGbGFnVGFibGUuU29ydEtleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuTlVNQkVSIH0sXG4gICAgICAgIGJpbGxpbmdNb2RlOiBCaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gICAgICAgIHRpbWVUb0xpdmVBdHRyaWJ1dGU6IER5bmFtb0RCVGFibGVQcm9wcy5UVExBdHRyaWJ1dGVOYW1lLFxuICAgICAgfVxuICAgICk7XG5cbiAgICAvLyBDcmVhdGVzIGEgRHluYW1vREIgVGFibGUgZm9yIHN0b3JpbmcgdGhlIGNhY2hlZCByb3V0ZXNcbiAgICB0aGlzLmNhY2hlZFJvdXRlc0R5bmFtb0RiID0gbmV3IGF3c19keW5hbW9kYi5UYWJsZSh0aGlzLCBEeW5hbW9EQlRhYmxlUHJvcHMuQ2FjaGVSb3V0ZUR5bmFtb0RiVGFibGUuTmFtZSwge1xuICAgICAgdGFibGVOYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuQ2FjaGVSb3V0ZUR5bmFtb0RiVGFibGUuTmFtZSxcbiAgICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuQ2FjaGVSb3V0ZUR5bmFtb0RiVGFibGUuUGFydGl0aW9uS2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgIHNvcnRLZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLkNhY2hlUm91dGVEeW5hbW9EYlRhYmxlLlNvcnRLZXlOYW1lLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICAgIHRpbWVUb0xpdmVBdHRyaWJ1dGU6IER5bmFtb0RCVGFibGVQcm9wcy5UVExBdHRyaWJ1dGVOYW1lLFxuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlcyBhIER5bmFtb0RCIFRhYmxlIGZvciBzdG9yaW5nIHRoZSBidWNrZXRzIHRoYXQgYXJlIGZsYWdnaW5nIGFzIGFscmVhZHkgY2FjaGVkIGluIHRoZSBDYWNoZWRSb3V0ZXNEYlxuICAgIHRoaXMuY2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGIgPSBuZXcgYXdzX2R5bmFtb2RiLlRhYmxlKFxuICAgICAgdGhpcyxcbiAgICAgIER5bmFtb0RCVGFibGVQcm9wcy5DYWNoaW5nUmVxdWVzdEZsYWdEeW5hbW9EYlRhYmxlLk5hbWUsXG4gICAgICB7XG4gICAgICAgIHRhYmxlTmFtZTogRHluYW1vREJUYWJsZVByb3BzLkNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiVGFibGUuTmFtZSxcbiAgICAgICAgcGFydGl0aW9uS2V5OiB7XG4gICAgICAgICAgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLkNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiVGFibGUuUGFydGl0aW9uS2V5TmFtZSxcbiAgICAgICAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgICAgICAgfSxcbiAgICAgICAgc29ydEtleTogeyBuYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuQ2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGJUYWJsZS5Tb3J0S2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgICAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgICB9XG4gICAgKTtcblxuICAgIC8vIENyZWF0ZXMgYSBEeW5hbW9EQiBUYWJsZSBmb3Igc3RvcmluZyB0aGUgY2FjaGVkIHYzIHBvb2xzXG4gICAgdGhpcy5jYWNoZWRWM1Bvb2xzRHluYW1vRGIgPSBuZXcgYXdzX2R5bmFtb2RiLlRhYmxlKHRoaXMsIER5bmFtb0RCVGFibGVQcm9wcy5WM1Bvb2xzRHluYW1vRGJUYWJsZS5OYW1lLCB7XG4gICAgICB0YWJsZU5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5WM1Bvb2xzRHluYW1vRGJUYWJsZS5OYW1lLFxuICAgICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5WM1Bvb2xzRHluYW1vRGJUYWJsZS5QYXJ0aXRpb25LZXlOYW1lLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgc29ydEtleTogeyBuYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuVjNQb29sc0R5bmFtb0RiVGFibGUuU29ydEtleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuTlVNQkVSIH0sXG4gICAgICBiaWxsaW5nTW9kZTogQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGVzIGEgVG9rZW5WYWxpZGF0aW9uUmVzdWx0IFRhYmxlIGZvciBzdG9yaW5nIHRoZSBGT1QvU0ZUIHRva2Vuc1xuICAgIHRoaXMudG9rZW5Qcm9wZXJ0aWVzQ2FjaGluZ0R5bmFtb0RiID0gbmV3IGF3c19keW5hbW9kYi5UYWJsZShcbiAgICAgIHRoaXMsXG4gICAgICBEeW5hbW9EQlRhYmxlUHJvcHMuVG9rZW5Qcm9wZXJ0aWVzQ2FjaGluZ0RiVGFibGUuTmFtZSxcbiAgICAgIHtcbiAgICAgICAgdGFibGVOYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuVG9rZW5Qcm9wZXJ0aWVzQ2FjaGluZ0RiVGFibGUuTmFtZSxcbiAgICAgICAgcGFydGl0aW9uS2V5OiB7XG4gICAgICAgICAgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlRva2VuUHJvcGVydGllc0NhY2hpbmdEYlRhYmxlLlBhcnRpdGlvbktleU5hbWUsXG4gICAgICAgICAgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdNb2RlOiBCaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gICAgICAgIHRpbWVUb0xpdmVBdHRyaWJ1dGU6IER5bmFtb0RCVGFibGVQcm9wcy5UVExBdHRyaWJ1dGVOYW1lLFxuICAgICAgfVxuICAgICk7XG4gIH1cbn1cbiJdfQ==